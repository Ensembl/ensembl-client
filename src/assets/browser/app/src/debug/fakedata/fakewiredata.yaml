t√°code:
    gc--LZ:
        code: |
            ; split transport format into parts
            ; IN:   #1 = gene-starts
            ;       #2 = gene-parts
            ;       #3 = part-type
            ;       #4 = UTR lengths
            ;       #5 = exon lengths
            ;       #6 = intron lengths
            ; OUT: #14 = part start
            ;      #11 = part len
            ;       #3 = part type
            ; TMP: #10, #12, #13
            runsof #10, #2, #1
            merge #11, #3, #4, #5, #6
            accn #12, #11, #2
            add #13, #10, #12
            const #14, [-1]
            mul #14, #11, #14
            add #14, #13, #14
            ; extract + draw
            ; IN:  #14 = part start
            ;      #11 = part len
            ;       #3 = part type
            ; USE: #10 = shape type
            ;      #12 = y-pos
            ;      #13 = height
            ;      #15 = colour
            ;      #16 = this type / elision array
            ; TMP:  #7 = elided starts
            ;       #8 = elided lens
            ;      #17 misc
            ; *** utr ***
            const #10, [1,0]
            const #12, [302]
            const #13, [6]
            const #15, [75,168,252]
            const #16, [0]
            eq #16, #3, #16
            move #7, #14
            const #17, [1]
            elide #7, #16, #17
            move #8, #11
            elide #8, #16, #17
            shape #10, #7, #8, #12, #13, #15
            ; *** exon ***
            const #10, [0,0]
            const #16, [1]
            eq #16, #3, #16
            move #7, #14
            const #17, [1]
            elide #7, #16, #17
            move #8, #11
            elide #8, #16, #17
            shape #10, #7, #8, #12, #13, #15
            ; *** intron ***
            const #10, [0,0]
            const #16, [2]
            const #12, [304]
            const #13, [2]
            eq #16, #3, #16
            move #7, #14
            const #17, [1]
            elide #7, #16, #17
            move #8, #11
            elide #8, #16, #17
            shape #10, #7, #8, #12, #13, #15
        data:
            - [1000,2500,3000]
            - [9,1,3]
            - [0,1,2,1,2,1,2,1,0,0,0,1,0]
            - [200,100,200,100,200]
            - [100,200,100,100,100]
            - [200,100,200]

    ################
    # CONTIG TRACK #
    ################

    # contig heatmap
    contig--AI:
        code: |
            ; #1 = starts
            ; #2 = lens
            ; #3 = colour box
            const #4, [233]
            const #5, [6]
            const #6, [192,192,192,128,128,128]
            const #7, [3]
            pick #6, #3, #6, #7
            shape #0, #1, #2, #4, #5, #6
        data:
            - contig:
                seed: 8
                len: 10000
                prop: 0.9
                pad: 20000
                shimmer: true

    # actual contigs
    contig--JO:
        code: |
            ; #1 = starts
            ; #2 = lens
            ; #3 = colour box
            const #4, [233]
            const #5, [6]
            const #6, [192,192,192,128,128,128]
            const #7, [3]
            pick #6, #3, #6, #7
            shape #0, #1, #2, #4, #5, #6
        data:
            - contig:
                seed: 8
                len: 10000
                prop: 0.9
                pad: 20000

    # boxes without letters in
    contig--PP:
        code: |
            ; #1 = start box frag
            ; #2 = len box frag
            ; #3 = colour box frag
            ; *** scales ***
            const #13, [232] ; #13 = box y-start
            const #14, [8] ; #14 = box y-height
            ; *** boxes ***
            runs #7, #1, #2    ; #7 = list of box starts
            const #16, [-0.45] ; #16 = left shift ~0.5bp
            add #7, #7, #16    ; #7 = starts shifted left 0.5bp
            const #12, [0.9]   ; #12 = box size
            runsof #3, #2, #3  ; #3 = colours to positions
            const #15, [192,192,192,128,128,128] ; #15 = box colour palette
            const #17, [3]     ; #17 = pallete stride 3
            pick #15, #3, #15, #17 ; #15 = box colours
            const #16, [1,1]   ; #16 = [hollow-box,spot-colour]
            shape #16, #7, #12, #13, #14, #15 ; draw boxes
        data:
            - contig:
                seed: 8
                len: 10000
                prop: 0.9
                pad: 10
 
    # boxes with letters in
    contig--QS:
        code: |
            ; #1 = sequence
            ; #2 = start pos of seq frag
            ; #3 = len of seq frag
            ; #4 = start box frag
            ; #5 = len box frag
            ; #6 = colour box frag
            ; *** scale (for size) ***
            const #16, [
                230,224,224,224,224,224,224,224,224,244
            ] ; #16 = y-starts Q, RZ
            const #17, [
                 12, 24, 24, 24, 24, 24, 24, 24, 24, 24
            ] ; #17 = y-sizes Q, RZ
            scale #18 ; #18 = scale
            const #19, [-16] ; #19 = start at Q
            add #18, #18, #19 ; #18 = scale (Q-based)
            get #13, #16, #18 ; #13 = box y-start
            get #14, #17, #18 ; #14 = box y-height
            ; *** boxes ***
            runs #7, #4, #5    ; #7 = list of box starts
            const #16, [-0.45] ; #16 = left shift ~0.5bp
            add #7, #7, #16    ; #7 = starts shifted left 0.5bp
            const #12, [0.9]   ; #12 = box size
            runsof #6, #5, #6  ; #6 = colours to positions
            const #15, [192,192,192,128,128,128] ; #15 = box colour palette
            const #17, [3]     ; #17 = pallete stride 3
            pick #15, #6, #15, #17 ; #15 = box colours
            const #16, [1,1]   ; #16 = [hollow-box,spot-colour]
            shape #16, #7, #12, #13, #14, #15 ; draw boxes
            ; *** sequence ***
            const #7, "ACGT"   ; #7 = available sequence
            const #8, [1,1,1,1]; #8 = lenget of seqeunces
            text #9, #7, #8    ; #9 = textures for A,C,G,T
            index #1, #1, #7   ; #1 = 0=A, 1=C, 2=G, 3=T for seq
            const #10, [1]     ; #10 = stride 1 for texture ids
            pick #9, #1, #9, #10 ; #9 = 0123 to tex id for seq
            const #11, [3,1]   ; #11 = [texture-pin]
            runs #7, #2, #3    ; #7 = position of sequence
            const #13, [239]   ; #13 = letter y-start
            shape #11, #7, #0, #13, #0, #9 ; draw letter
        data:
            - contig:
                seed: 8
                len: 10000
                prop: 0.9
                pad: 0
                seq: true
            - contig:
                seed: 8
                len: 10000
                prop: 0.9
                pad: 20000
