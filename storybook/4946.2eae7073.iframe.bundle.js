/*! For license information please see 4946.2eae7073.iframe.bundle.js.LICENSE.txt */
"use strict";(globalThis.webpackChunkensembl_new=globalThis.webpackChunkensembl_new||[]).push([[4946],{"./node_modules/comlink/dist/esm/comlink.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>expose});const proxyMarker=Symbol("Comlink.proxy"),createEndpoint=Symbol("Comlink.endpoint"),releaseProxy=Symbol("Comlink.releaseProxy"),finalizer=Symbol("Comlink.finalizer"),throwMarker=Symbol("Comlink.thrown"),isObject=val=>"object"==typeof val&&null!==val||"function"==typeof val,proxyTransferHandler={canHandle:val=>isObject(val)&&val[proxyMarker],serialize(obj){const{port1,port2}=new MessageChannel;return expose(obj,port1),[port2,[port2]]},deserialize:port=>(port.start(),function wrap(ep,target){const pendingListeners=new Map;return ep.addEventListener("message",(function handleMessage(ev){const{data}=ev;if(!data||!data.id)return;const resolver=pendingListeners.get(data.id);if(resolver)try{resolver(data)}finally{pendingListeners.delete(data.id)}})),createProxy(ep,pendingListeners,[],target)}(port))},transferHandlers=new Map([["proxy",proxyTransferHandler],["throw",{canHandle:value=>isObject(value)&&throwMarker in value,serialize({value}){let serialized;return serialized=value instanceof Error?{isError:!0,value:{message:value.message,name:value.name,stack:value.stack}}:{isError:!1,value},[serialized,[]]},deserialize(serialized){if(serialized.isError)throw Object.assign(new Error(serialized.value.message),serialized.value);throw serialized.value}}]]);function expose(obj,ep=globalThis,allowedOrigins=["*"]){ep.addEventListener("message",(function callback(ev){if(!ev||!ev.data)return;if(!function isAllowedOrigin(allowedOrigins,origin){for(const allowedOrigin of allowedOrigins){if(origin===allowedOrigin||"*"===allowedOrigin)return!0;if(allowedOrigin instanceof RegExp&&allowedOrigin.test(origin))return!0}return!1}(allowedOrigins,ev.origin))return void console.warn(`Invalid origin '${ev.origin}' for comlink proxy`);const{id,type,path}=Object.assign({path:[]},ev.data),argumentList=(ev.data.argumentList||[]).map(fromWireValue);let returnValue;try{const parent=path.slice(0,-1).reduce(((obj,prop)=>obj[prop]),obj),rawValue=path.reduce(((obj,prop)=>obj[prop]),obj);switch(type){case"GET":returnValue=rawValue;break;case"SET":parent[path.slice(-1)[0]]=fromWireValue(ev.data.value),returnValue=!0;break;case"APPLY":returnValue=rawValue.apply(parent,argumentList);break;case"CONSTRUCT":returnValue=function proxy(obj){return Object.assign(obj,{[proxyMarker]:!0})}(new rawValue(...argumentList));break;case"ENDPOINT":{const{port1,port2}=new MessageChannel;expose(obj,port2),returnValue=function transfer(obj,transfers){return transferCache.set(obj,transfers),obj}(port1,[port1])}break;case"RELEASE":returnValue=void 0;break;default:return}}catch(value){returnValue={value,[throwMarker]:0}}Promise.resolve(returnValue).catch((value=>({value,[throwMarker]:0}))).then((returnValue=>{const[wireValue,transferables]=toWireValue(returnValue);ep.postMessage(Object.assign(Object.assign({},wireValue),{id}),transferables),"RELEASE"===type&&(ep.removeEventListener("message",callback),closeEndPoint(ep),finalizer in obj&&"function"==typeof obj[finalizer]&&obj[finalizer]())})).catch((error=>{const[wireValue,transferables]=toWireValue({value:new TypeError("Unserializable return value"),[throwMarker]:0});ep.postMessage(Object.assign(Object.assign({},wireValue),{id}),transferables)}))})),ep.start&&ep.start()}function closeEndPoint(endpoint){(function isMessagePort(endpoint){return"MessagePort"===endpoint.constructor.name})(endpoint)&&endpoint.close()}function throwIfProxyReleased(isReleased){if(isReleased)throw new Error("Proxy has been released and is not useable")}function releaseEndpoint(ep){return requestResponseMessage(ep,new Map,{type:"RELEASE"}).then((()=>{closeEndPoint(ep)}))}const proxyCounter=new WeakMap,proxyFinalizers="FinalizationRegistry"in globalThis&&new FinalizationRegistry((ep=>{const newCount=(proxyCounter.get(ep)||0)-1;proxyCounter.set(ep,newCount),0===newCount&&releaseEndpoint(ep)}));function createProxy(ep,pendingListeners,path=[],target=function(){}){let isProxyReleased=!1;const proxy=new Proxy(target,{get(_target,prop){if(throwIfProxyReleased(isProxyReleased),prop===releaseProxy)return()=>{!function unregisterProxy(proxy){proxyFinalizers&&proxyFinalizers.unregister(proxy)}(proxy),releaseEndpoint(ep),pendingListeners.clear(),isProxyReleased=!0};if("then"===prop){if(0===path.length)return{then:()=>proxy};const r=requestResponseMessage(ep,pendingListeners,{type:"GET",path:path.map((p=>p.toString()))}).then(fromWireValue);return r.then.bind(r)}return createProxy(ep,pendingListeners,[...path,prop])},set(_target,prop,rawValue){throwIfProxyReleased(isProxyReleased);const[value,transferables]=toWireValue(rawValue);return requestResponseMessage(ep,pendingListeners,{type:"SET",path:[...path,prop].map((p=>p.toString())),value},transferables).then(fromWireValue)},apply(_target,_thisArg,rawArgumentList){throwIfProxyReleased(isProxyReleased);const last=path[path.length-1];if(last===createEndpoint)return requestResponseMessage(ep,pendingListeners,{type:"ENDPOINT"}).then(fromWireValue);if("bind"===last)return createProxy(ep,pendingListeners,path.slice(0,-1));const[argumentList,transferables]=processArguments(rawArgumentList);return requestResponseMessage(ep,pendingListeners,{type:"APPLY",path:path.map((p=>p.toString())),argumentList},transferables).then(fromWireValue)},construct(_target,rawArgumentList){throwIfProxyReleased(isProxyReleased);const[argumentList,transferables]=processArguments(rawArgumentList);return requestResponseMessage(ep,pendingListeners,{type:"CONSTRUCT",path:path.map((p=>p.toString())),argumentList},transferables).then(fromWireValue)}});return function registerProxy(proxy,ep){const newCount=(proxyCounter.get(ep)||0)+1;proxyCounter.set(ep,newCount),proxyFinalizers&&proxyFinalizers.register(proxy,ep,proxy)}(proxy,ep),proxy}function processArguments(argumentList){const processed=argumentList.map(toWireValue);return[processed.map((v=>v[0])),(arr=processed.map((v=>v[1])),Array.prototype.concat.apply([],arr))];var arr}const transferCache=new WeakMap;function toWireValue(value){for(const[name,handler]of transferHandlers)if(handler.canHandle(value)){const[serializedValue,transferables]=handler.serialize(value);return[{type:"HANDLER",name,value:serializedValue},transferables]}return[{type:"RAW",value},transferCache.get(value)||[]]}function fromWireValue(value){switch(value.type){case"HANDLER":return transferHandlers.get(value.name).deserialize(value.value);case"RAW":return value.value}}function requestResponseMessage(ep,pendingListeners,msg,transfers){return new Promise((resolve=>{const id=function generateUUID(){return new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-")}();pendingListeners.set(id,resolve),ep.start&&ep.start(),ep.postMessage(Object.assign({id},msg),transfers)}))}},"./node_modules/core-js/internals/call-with-safe-iteration-closing.js":(module,__unused_webpack_exports,__webpack_require__)=>{var anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),iteratorClose=__webpack_require__("./node_modules/core-js/internals/iterator-close.js");module.exports=function(iterator,fn,value,ENTRIES){try{return ENTRIES?fn(anObject(value)[0],value[1]):fn(value)}catch(error){iteratorClose(iterator,"throw",error)}}},"./node_modules/core-js/internals/classof.js":(module,__unused_webpack_exports,__webpack_require__)=>{var TO_STRING_TAG_SUPPORT=__webpack_require__("./node_modules/core-js/internals/to-string-tag-support.js"),isCallable=__webpack_require__("./node_modules/core-js/internals/is-callable.js"),classofRaw=__webpack_require__("./node_modules/core-js/internals/classof-raw.js"),TO_STRING_TAG=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js")("toStringTag"),$Object=Object,CORRECT_ARGUMENTS="Arguments"===classofRaw(function(){return arguments}());module.exports=TO_STRING_TAG_SUPPORT?classofRaw:function(it){var O,tag,result;return void 0===it?"Undefined":null===it?"Null":"string"==typeof(tag=function(it,key){try{return it[key]}catch(error){}}(O=$Object(it),TO_STRING_TAG))?tag:CORRECT_ARGUMENTS?classofRaw(O):"Object"===(result=classofRaw(O))&&isCallable(O.callee)?"Arguments":result}},"./node_modules/core-js/internals/create-iter-result-object.js":module=>{module.exports=function(value,done){return{value,done}}},"./node_modules/core-js/internals/define-built-ins.js":(module,__unused_webpack_exports,__webpack_require__)=>{var defineBuiltIn=__webpack_require__("./node_modules/core-js/internals/define-built-in.js");module.exports=function(target,src,options){for(var key in src)defineBuiltIn(target,key,src[key],options);return target}},"./node_modules/core-js/internals/function-bind-context.js":(module,__unused_webpack_exports,__webpack_require__)=>{var uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this-clause.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),NATIVE_BIND=__webpack_require__("./node_modules/core-js/internals/function-bind-native.js"),bind=uncurryThis(uncurryThis.bind);module.exports=function(fn,that){return aCallable(fn),void 0===that?fn:NATIVE_BIND?bind(fn,that):function(){return fn.apply(that,arguments)}}},"./node_modules/core-js/internals/function-uncurry-this-clause.js":(module,__unused_webpack_exports,__webpack_require__)=>{var classofRaw=__webpack_require__("./node_modules/core-js/internals/classof-raw.js"),uncurryThis=__webpack_require__("./node_modules/core-js/internals/function-uncurry-this.js");module.exports=function(fn){if("Function"===classofRaw(fn))return uncurryThis(fn)}},"./node_modules/core-js/internals/get-iterator-method.js":(module,__unused_webpack_exports,__webpack_require__)=>{var classof=__webpack_require__("./node_modules/core-js/internals/classof.js"),getMethod=__webpack_require__("./node_modules/core-js/internals/get-method.js"),isNullOrUndefined=__webpack_require__("./node_modules/core-js/internals/is-null-or-undefined.js"),Iterators=__webpack_require__("./node_modules/core-js/internals/iterators.js"),ITERATOR=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js")("iterator");module.exports=function(it){if(!isNullOrUndefined(it))return getMethod(it,ITERATOR)||getMethod(it,"@@iterator")||Iterators[classof(it)]}},"./node_modules/core-js/internals/get-iterator.js":(module,__unused_webpack_exports,__webpack_require__)=>{var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),tryToString=__webpack_require__("./node_modules/core-js/internals/try-to-string.js"),getIteratorMethod=__webpack_require__("./node_modules/core-js/internals/get-iterator-method.js"),$TypeError=TypeError;module.exports=function(argument,usingIterator){var iteratorMethod=arguments.length<2?getIteratorMethod(argument):usingIterator;if(aCallable(iteratorMethod))return anObject(call(iteratorMethod,argument));throw new $TypeError(tryToString(argument)+" is not iterable")}},"./node_modules/core-js/internals/is-array-iterator-method.js":(module,__unused_webpack_exports,__webpack_require__)=>{var wellKnownSymbol=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js"),Iterators=__webpack_require__("./node_modules/core-js/internals/iterators.js"),ITERATOR=wellKnownSymbol("iterator"),ArrayPrototype=Array.prototype;module.exports=function(it){return void 0!==it&&(Iterators.Array===it||ArrayPrototype[ITERATOR]===it)}},"./node_modules/core-js/internals/iterate.js":(module,__unused_webpack_exports,__webpack_require__)=>{var bind=__webpack_require__("./node_modules/core-js/internals/function-bind-context.js"),call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),tryToString=__webpack_require__("./node_modules/core-js/internals/try-to-string.js"),isArrayIteratorMethod=__webpack_require__("./node_modules/core-js/internals/is-array-iterator-method.js"),lengthOfArrayLike=__webpack_require__("./node_modules/core-js/internals/length-of-array-like.js"),isPrototypeOf=__webpack_require__("./node_modules/core-js/internals/object-is-prototype-of.js"),getIterator=__webpack_require__("./node_modules/core-js/internals/get-iterator.js"),getIteratorMethod=__webpack_require__("./node_modules/core-js/internals/get-iterator-method.js"),iteratorClose=__webpack_require__("./node_modules/core-js/internals/iterator-close.js"),$TypeError=TypeError,Result=function(stopped,result){this.stopped=stopped,this.result=result},ResultPrototype=Result.prototype;module.exports=function(iterable,unboundFunction,options){var iterator,iterFn,index,length,result,next,step,that=options&&options.that,AS_ENTRIES=!(!options||!options.AS_ENTRIES),IS_RECORD=!(!options||!options.IS_RECORD),IS_ITERATOR=!(!options||!options.IS_ITERATOR),INTERRUPTED=!(!options||!options.INTERRUPTED),fn=bind(unboundFunction,that),stop=function(condition){return iterator&&iteratorClose(iterator,"normal",condition),new Result(!0,condition)},callFn=function(value){return AS_ENTRIES?(anObject(value),INTERRUPTED?fn(value[0],value[1],stop):fn(value[0],value[1])):INTERRUPTED?fn(value,stop):fn(value)};if(IS_RECORD)iterator=iterable.iterator;else if(IS_ITERATOR)iterator=iterable;else{if(!(iterFn=getIteratorMethod(iterable)))throw new $TypeError(tryToString(iterable)+" is not iterable");if(isArrayIteratorMethod(iterFn)){for(index=0,length=lengthOfArrayLike(iterable);length>index;index++)if((result=callFn(iterable[index]))&&isPrototypeOf(ResultPrototype,result))return result;return new Result(!1)}iterator=getIterator(iterable,iterFn)}for(next=IS_RECORD?iterable.next:iterator.next;!(step=call(next,iterator)).done;){try{result=callFn(step.value)}catch(error){iteratorClose(iterator,"throw",error)}if("object"==typeof result&&result&&isPrototypeOf(ResultPrototype,result))return result}return new Result(!1)}},"./node_modules/core-js/internals/iterator-create-proxy.js":(module,__unused_webpack_exports,__webpack_require__)=>{var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),create=__webpack_require__("./node_modules/core-js/internals/object-create.js"),createNonEnumerableProperty=__webpack_require__("./node_modules/core-js/internals/create-non-enumerable-property.js"),defineBuiltIns=__webpack_require__("./node_modules/core-js/internals/define-built-ins.js"),wellKnownSymbol=__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js"),InternalStateModule=__webpack_require__("./node_modules/core-js/internals/internal-state.js"),getMethod=__webpack_require__("./node_modules/core-js/internals/get-method.js"),IteratorPrototype=__webpack_require__("./node_modules/core-js/internals/iterators-core.js").IteratorPrototype,createIterResultObject=__webpack_require__("./node_modules/core-js/internals/create-iter-result-object.js"),iteratorClose=__webpack_require__("./node_modules/core-js/internals/iterator-close.js"),TO_STRING_TAG=wellKnownSymbol("toStringTag"),setInternalState=InternalStateModule.set,createIteratorProxyPrototype=function(IS_ITERATOR){var getInternalState=InternalStateModule.getterFor(IS_ITERATOR?"WrapForValidIterator":"IteratorHelper");return defineBuiltIns(create(IteratorPrototype),{next:function next(){var state=getInternalState(this);if(IS_ITERATOR)return state.nextHandler();if(state.done)return createIterResultObject(void 0,!0);try{var result=state.nextHandler();return state.returnHandlerResult?result:createIterResultObject(result,state.done)}catch(error){throw state.done=!0,error}},return:function(){var state=getInternalState(this),iterator=state.iterator;if(state.done=!0,IS_ITERATOR){var returnMethod=getMethod(iterator,"return");return returnMethod?call(returnMethod,iterator):createIterResultObject(void 0,!0)}if(state.inner)try{iteratorClose(state.inner.iterator,"normal")}catch(error){return iteratorClose(iterator,"throw",error)}return iterator&&iteratorClose(iterator,"normal"),createIterResultObject(void 0,!0)}})},WrapForValidIteratorPrototype=createIteratorProxyPrototype(!0),IteratorHelperPrototype=createIteratorProxyPrototype(!1);createNonEnumerableProperty(IteratorHelperPrototype,TO_STRING_TAG,"Iterator Helper"),module.exports=function(nextHandler,IS_ITERATOR,RETURN_HANDLER_RESULT){var IteratorProxy=function Iterator(record,state){state?(state.iterator=record.iterator,state.next=record.next):state=record,state.type=IS_ITERATOR?"WrapForValidIterator":"IteratorHelper",state.returnHandlerResult=!!RETURN_HANDLER_RESULT,state.nextHandler=nextHandler,state.counter=0,state.done=!1,setInternalState(this,state)};return IteratorProxy.prototype=IS_ITERATOR?WrapForValidIteratorPrototype:IteratorHelperPrototype,IteratorProxy}},"./node_modules/core-js/internals/iterator-map.js":(module,__unused_webpack_exports,__webpack_require__)=>{var call=__webpack_require__("./node_modules/core-js/internals/function-call.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js"),createIteratorProxy=__webpack_require__("./node_modules/core-js/internals/iterator-create-proxy.js"),callWithSafeIterationClosing=__webpack_require__("./node_modules/core-js/internals/call-with-safe-iteration-closing.js"),IteratorProxy=createIteratorProxy((function(){var iterator=this.iterator,result=anObject(call(this.next,iterator));if(!(this.done=!!result.done))return callWithSafeIterationClosing(iterator,this.mapper,[result.value,this.counter++],!0)}));module.exports=function map(mapper){return anObject(this),aCallable(mapper),new IteratorProxy(getIteratorDirect(this),{mapper})}},"./node_modules/core-js/internals/iterators.js":module=>{module.exports={}},"./node_modules/core-js/internals/object-define-property.js":(__unused_webpack_module,exports,__webpack_require__)=>{var DESCRIPTORS=__webpack_require__("./node_modules/core-js/internals/descriptors.js"),IE8_DOM_DEFINE=__webpack_require__("./node_modules/core-js/internals/ie8-dom-define.js"),V8_PROTOTYPE_DEFINE_BUG=__webpack_require__("./node_modules/core-js/internals/v8-prototype-define-bug.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),toPropertyKey=__webpack_require__("./node_modules/core-js/internals/to-property-key.js"),$TypeError=TypeError,$defineProperty=Object.defineProperty,$getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;exports.f=DESCRIPTORS?V8_PROTOTYPE_DEFINE_BUG?function defineProperty(O,P,Attributes){if(anObject(O),P=toPropertyKey(P),anObject(Attributes),"function"==typeof O&&"prototype"===P&&"value"in Attributes&&"writable"in Attributes&&!Attributes.writable){var current=$getOwnPropertyDescriptor(O,P);current&&current.writable&&(O[P]=Attributes.value,Attributes={configurable:"configurable"in Attributes?Attributes.configurable:current.configurable,enumerable:"enumerable"in Attributes?Attributes.enumerable:current.enumerable,writable:!1})}return $defineProperty(O,P,Attributes)}:$defineProperty:function defineProperty(O,P,Attributes){if(anObject(O),P=toPropertyKey(P),anObject(Attributes),IE8_DOM_DEFINE)try{return $defineProperty(O,P,Attributes)}catch(error){}if("get"in Attributes||"set"in Attributes)throw new $TypeError("Accessors not supported");return"value"in Attributes&&(O[P]=Attributes.value),O}},"./node_modules/core-js/internals/to-string-tag-support.js":(module,__unused_webpack_exports,__webpack_require__)=>{var test={};test[__webpack_require__("./node_modules/core-js/internals/well-known-symbol.js")("toStringTag")]="z",module.exports="[object z]"===String(test)},"./node_modules/core-js/modules/es.iterator.find.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("./node_modules/core-js/internals/export.js"),iterate=__webpack_require__("./node_modules/core-js/internals/iterate.js"),aCallable=__webpack_require__("./node_modules/core-js/internals/a-callable.js"),anObject=__webpack_require__("./node_modules/core-js/internals/an-object.js"),getIteratorDirect=__webpack_require__("./node_modules/core-js/internals/get-iterator-direct.js");$({target:"Iterator",proto:!0,real:!0},{find:function find(predicate){anObject(this),aCallable(predicate);var record=getIteratorDirect(this),counter=0;return iterate(record,(function(value,stop){if(predicate(value,counter++))return stop(value)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})},"./node_modules/core-js/modules/es.iterator.map.js":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var $=__webpack_require__("./node_modules/core-js/internals/export.js"),map=__webpack_require__("./node_modules/core-js/internals/iterator-map.js");$({target:"Iterator",proto:!0,real:!0,forced:__webpack_require__("./node_modules/core-js/internals/is-pure.js")},{map})},"./node_modules/graphql-request/build/esm/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{l4:()=>GraphQLClient,J1:()=>gql});var defaultJsonSerializer=__webpack_require__("./node_modules/graphql-request/build/esm/defaultJsonSerializer.js"),helpers=__webpack_require__("./node_modules/graphql-request/build/esm/helpers.js");var resolveRequestDocument=__webpack_require__("./node_modules/graphql-request/build/esm/resolveRequestDocument.js"),types=__webpack_require__("./node_modules/graphql-request/build/esm/types.js"),browser_ponyfill=__webpack_require__("./node_modules/cross-fetch/dist/browser-ponyfill.js"),browser_ponyfill_default=__webpack_require__.n(browser_ponyfill);__webpack_require__("./node_modules/graphql-request/build/esm/graphql-ws.js");const resolveHeaders=headers=>{let oHeaders={};return headers&&("undefined"!=typeof Headers&&headers instanceof Headers||browser_ponyfill&&browser_ponyfill.Headers&&headers instanceof browser_ponyfill.Headers?oHeaders=(0,helpers.Y)(headers):Array.isArray(headers)?headers.forEach((([name,value])=>{name&&void 0!==value&&(oHeaders[name]=value)})):oHeaders=headers),oHeaders},cleanQuery=str=>str.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),createHttpMethodFetcher=method=>async params=>{const{url,query,variables,operationName,fetch,fetchOptions,middleware}=params,headers={...params.headers};let body,queryParams="";"POST"===method?(body=createRequestBody(query,variables,operationName,fetchOptions.jsonSerializer),"string"==typeof body&&(headers["Content-Type"]="application/json")):queryParams=(params=>{if(!Array.isArray(params.query)){const params_=params,search=[`query=${encodeURIComponent(cleanQuery(params_.query))}`];return params.variables&&search.push(`variables=${encodeURIComponent(params_.jsonSerializer.stringify(params_.variables))}`),params_.operationName&&search.push(`operationName=${encodeURIComponent(params_.operationName)}`),search.join("&")}if(void 0!==params.variables&&!Array.isArray(params.variables))throw new Error("Cannot create query with given variable type, array expected");const params_=params,payload=params.query.reduce(((acc,currentQuery,index)=>(acc.push({query:cleanQuery(currentQuery),variables:params_.variables?params_.jsonSerializer.stringify(params_.variables[index]):void 0}),acc)),[]);return`query=${encodeURIComponent(params_.jsonSerializer.stringify(payload))}`})({query,variables,operationName,jsonSerializer:fetchOptions.jsonSerializer??defaultJsonSerializer.k});const init={method,headers,body,...fetchOptions};let urlResolved=url,initResolved=init;if(middleware){const result=await Promise.resolve(middleware({...init,url,operationName,variables})),{url:urlNew,...initNew}=result;urlResolved=urlNew,initResolved=initNew}return queryParams&&(urlResolved=`${urlResolved}?${queryParams}`),await fetch(urlResolved,initResolved)};class GraphQLClient{constructor(url,requestConfig={}){this.url=url,this.requestConfig=requestConfig,this.rawRequest=async(...args)=>{const[queryOrOptions,variables,requestHeaders]=args,rawRequestOptions=((queryOrOptions,variables,requestHeaders)=>queryOrOptions.query?queryOrOptions:{query:queryOrOptions,variables,requestHeaders,signal:void 0})(queryOrOptions,variables,requestHeaders),{headers,fetch=browser_ponyfill_default(),method="POST",requestMiddleware,responseMiddleware,...fetchOptions}=this.requestConfig,{url}=this;void 0!==rawRequestOptions.signal&&(fetchOptions.signal=rawRequestOptions.signal);const{operationName}=(0,resolveRequestDocument.V)(rawRequestOptions.query);return makeRequest({url,query:rawRequestOptions.query,variables:rawRequestOptions.variables,headers:{...resolveHeaders(callOrIdentity(headers)),...resolveHeaders(rawRequestOptions.requestHeaders)},operationName,fetch,method,fetchOptions,middleware:requestMiddleware}).then((response=>(responseMiddleware&&responseMiddleware(response),response))).catch((error=>{throw responseMiddleware&&responseMiddleware(error),error}))}}async request(documentOrOptions,...variablesAndRequestHeaders){const[variables,requestHeaders]=variablesAndRequestHeaders,requestOptions=((documentOrOptions,variables,requestHeaders)=>documentOrOptions.document?documentOrOptions:{document:documentOrOptions,variables,requestHeaders,signal:void 0})(documentOrOptions,variables,requestHeaders),{headers,fetch=browser_ponyfill_default(),method="POST",requestMiddleware,responseMiddleware,...fetchOptions}=this.requestConfig,{url}=this;void 0!==requestOptions.signal&&(fetchOptions.signal=requestOptions.signal);const{query,operationName}=(0,resolveRequestDocument.V)(requestOptions.document);return makeRequest({url,query,variables:requestOptions.variables,headers:{...resolveHeaders(callOrIdentity(headers)),...resolveHeaders(requestOptions.requestHeaders)},operationName,fetch,method,fetchOptions,middleware:requestMiddleware}).then((response=>(responseMiddleware&&responseMiddleware(response),response.data))).catch((error=>{throw responseMiddleware&&responseMiddleware(error),error}))}batchRequests(documentsOrOptions,requestHeaders){const batchRequestOptions=((documentsOrOptions,requestHeaders)=>documentsOrOptions.documents?documentsOrOptions:{documents:documentsOrOptions,requestHeaders,signal:void 0})(documentsOrOptions,requestHeaders),{headers,...fetchOptions}=this.requestConfig;void 0!==batchRequestOptions.signal&&(fetchOptions.signal=batchRequestOptions.signal);const queries=batchRequestOptions.documents.map((({document})=>(0,resolveRequestDocument.V)(document).query)),variables=batchRequestOptions.documents.map((({variables})=>variables));return makeRequest({url:this.url,query:queries,variables,headers:{...resolveHeaders(callOrIdentity(headers)),...resolveHeaders(batchRequestOptions.requestHeaders)},operationName:void 0,fetch:this.requestConfig.fetch??browser_ponyfill_default(),method:this.requestConfig.method||"POST",fetchOptions,middleware:this.requestConfig.requestMiddleware}).then((response=>(this.requestConfig.responseMiddleware&&this.requestConfig.responseMiddleware(response),response.data))).catch((error=>{throw this.requestConfig.responseMiddleware&&this.requestConfig.responseMiddleware(error),error}))}setHeaders(headers){return this.requestConfig.headers=headers,this}setHeader(key,value){const{headers}=this.requestConfig;return headers?headers[key]=value:this.requestConfig.headers={[key]:value},this}setEndpoint(value){return this.url=value,this}}const makeRequest=async params=>{const{query,variables,fetchOptions}=params,fetcher=createHttpMethodFetcher((0,helpers.Z)(params.method??"post")),isBatchingQuery=Array.isArray(params.query),response=await fetcher(params),result=await getResult(response,fetchOptions.jsonSerializer??defaultJsonSerializer.k),successfullyReceivedData=Array.isArray(result)?!result.some((({data})=>!data)):Boolean(result.data),successfullyPassedErrorPolicy=Array.isArray(result)||!result.errors||Array.isArray(result.errors)&&!result.errors.length||"all"===fetchOptions.errorPolicy||"ignore"===fetchOptions.errorPolicy;if(response.ok&&successfullyPassedErrorPolicy&&successfullyReceivedData){const{errors:_,...rest}=(Array.isArray(result),result),data="ignore"===fetchOptions.errorPolicy?rest:result;return{...isBatchingQuery?{data}:data,headers:response.headers,status:response.status}}{const errorResult="string"==typeof result?{error:result}:result;throw new types.M({...errorResult,status:response.status,headers:response.headers},{query,variables})}};const createRequestBody=(query,variables,operationName,jsonSerializer)=>{const jsonSerializer_=jsonSerializer??defaultJsonSerializer.k;if(!Array.isArray(query))return jsonSerializer_.stringify({query,variables,operationName});if(void 0!==variables&&!Array.isArray(variables))throw new Error("Cannot create request body with given variable type, array expected");const payload=query.reduce(((acc,currentQuery,index)=>(acc.push({query:currentQuery,variables:variables?variables[index]:void 0}),acc)),[]);return jsonSerializer_.stringify(payload)},getResult=async(response,jsonSerializer)=>{let contentType;return response.headers.forEach(((value,key)=>{"content-type"===key.toLowerCase()&&(contentType=value)})),contentType&&(contentType.toLowerCase().startsWith("application/json")||contentType.toLowerCase().startsWith("application/graphql+json")||contentType.toLowerCase().startsWith("application/graphql-response+json"))?jsonSerializer.parse(await response.text()):response.text()},callOrIdentity=value=>"function"==typeof value?value():value,gql=(chunks,...variables)=>chunks.reduce(((acc,chunk,index)=>`${acc}${chunk}${index in variables?String(variables[index]):""}`),"")}}]);